\pgfplotstableset{
	begin table={\rowcolors{2}{gray!25}{white}\begin{tabular}},
	end table=\end{tabular},
}

\mytitlepage{прикладной математики}{2}{Уравнения математической физики}{Решение эллиптических краевых задач методом конечных разностей}{ПМ-63}{Шепрут И.И.}{5}{Патрушев И.И.}{2019}

\section{Цель работы}

Разработать программу решения нелинейной одномерной краевой задачи методом конечных элементов. Провести сравнение метода простой итерации и метода Ньютона для решения данной задачи.

\section{Задание}

\begin{easylist}
\ListProperties(Hang=true, Margin2=12pt, Style2**=$\bullet$ , Hide2=2, Hide1=0)
& Выполнить конечноэлементную аппроксимацию исходного уравнения в соответствии с заданием. Получить формулы для вычисления компонент матрицы A и вектора правой части b для метода простой итерации.
& Реализовать программу решения нелинейной задачи методом простой итерации с учетом следующих требований:
&& язык программирования С++ или Фортран;
&& предусмотреть возможность задания неравномерных сеток по пространству и по времени, разрывность параметров уравнения по подобластям, учет краевых условий;
&&  матрицу хранить в ленточном формате, для решения СЛАУ использовать метод LU -разложения;
&& предусмотреть возможность использования параметра релаксации.
& Протестировать разработанную программу.
& Провести исследования реализованных методов на различных зависимостях коэффициента от решения (или производной решения) в соответствии с заданием. На одних и тех же задачах сравнить по количеству итераци метод простой итерации. Исследовать скорость сходимости от параметра релаксации.
\end{easylist}

\textbf{Вариант 5:} уравнение $-\operatorname{div}\left(\lambda(u)\operatorname{grad} u\right) + \sigma \frac{\partial u}{\partial t} = f$. Базисные функции  - линейные.

\section{Исследования}

Далее под точностью решения будет подразумеваться $L_2$ норма между вектором $q$, полученным в ходе решения, на последнем моменте времени, и между реальным значением узлов, которые мы знаем, задавая функцию $u$. В исследованиях на порядок сходимости эта норма будет ещё делиться на число элементов, для нахождения среднего отклонения от идеального решения.

\subsection{Точность для разных функций}

Здесь показана точность решения и количество итераций в зависимости от функций $u(x, t)$ и $\lambda(u)$. Запускается со следующими параметрами:

\begin{easylist}
\ListProperties(Hang1=true, Margin2=12pt, Style1**=$\bullet$ , Hide1=1)
& $sigma = 1$.
& $\varepsilon = 0.001$.
& $\mathrm{iters}_{max} = 500$.
& Функция правой части высчитывается автоматически.
& Сетка по пространству равномерная: $(1, 1.1, \dots, 1.9, 2)$. Сетка по времени равномерная: $(0, 0.1, \dots, 0.9, 1)$.
& Начальное приближение: для функций $u$, линейных по $t$ --- $(1, 1, \dots)$.
& Для функций $u$, нелинейных по $t$ начальное приближение в момент $t=0$ --- $(u(1, 0), u(1.1, 0), $ $ \dots, u(1.9, 0), u(2, 0))$, то есть истинное решение.
\end{easylist}

\begin{center}
\noindent\pgfplotstabletypeset[
	columns={a,$1$,$u$,$u^2$,$u^2+1$,$u^3$,$u^4$,$e^u$,sinu},
	columns/a/.style={string type, column name={\backslashbox{$u(x, t)$}{$\lambda(u)$}}},
	columns/$1$/.style={string type},
	columns/$u$/.style={string type},
	columns/$u^2$/.style={string type},
	columns/$u^2+1$/.style={string type},
	columns/$u^3$/.style={string type},
	columns/$u^4$/.style={string type},
	columns/$e^u$/.style={string type},
	columns/sinu/.style={string type, column name={$\sin u$}, column type/.add={}{|},},
	every head row/.style={before row=\hline,after row=\hline\hline}, 
	every last row/.style={after row=\hline},
	column type/.add={|}{},
	col sep=tab,
]{first.txt}
\end{center}

\subsection{Зависимость точности от нелинейной сетки}

\subsubsection{Функции нелинейной сетки}

В ходе выполнения лабораторной работы были обнаружены функции, позволяющие легко задавать неравномерную сетку, сгущающуюяся к одному из концов.

Если у нас задано начало --- $a$ и конец сетки --- $b$, а количество элементов $n$, тогда сетку можно задать следующим образом:

$$ x_i = a + m\left(\frac{i}{n}\right) \cdot (b-a), i=\overline{0, n} $$,

где $m(x)$ --- некоторая функция, задающая неравномерную сетку. При этом $x$ обязан принадлежать области $[0, 1]$, а функция $m$ возвращать значения из той же области, и при этом быть строго монотонной на этом участке. Тогда гарантируется условие на сетке, что $x_j \leqslant x_i$ при $j \leqslant i$. 

\textit{Пример:} при $m(x) = x$, сетка становится равномерной.

Найденные функции зависят от некоторого параметра t:

\begin{center}\begin{tabular}{cc}
$ m_{1, t}(x) = x^t $ & $ m_{2, t}(x) = x^\frac{1}{t} $ \\
$ m_{3, t}(x) = \frac{t^x-1}{t-1} $ & $ m_{4, t}(x) = \frac{\frac{1}{t^x}}{\frac{1}{t}-1} $
\end{tabular}\end{center}

Что интересно, эти функции вырождаются в $x$ при $t=1$, а при $t=0$, они вырождаются в сетку, полностью находящуюся на одном из концов: 1, 3 фукнции стремятся к концу $b$; а функции 2, 4 стремятся к концу $a$. 1 и 2 функции симметричны друг другу, как 3 и 4.

Таким образом, можно исследовать различные неравномерные сетки на итоговую точность и число итераций, изменяя параметр от $0$ до $1$.

\subsubsection{Описание исследований}

Параметры остаются прежними, с небольшими изменениями:

\begin{easylist}
\ListProperties(Hang1=true, Margin2=12pt, Style1**=$\bullet$ , Hide1=1)
& $\mathrm{iters}_{max} = 100$.
& Сетка по пространству неравномерная, если исследование происходит по сетке пространству, и равномерная, если исследование происходит по сетке времени.
\end{easylist}

Исследуется скорость и качество сходимости в зависимости от параметра неравномерной сетки. Так же некоторые графики разделены для того, чтобы можно было что-то различить на них.

\newcommand{\graphgrid}[1]{
\noindent\begin{tikzpicture}
\begin{semilogyaxis}[xlabel=t,ylabel=Точность решения,width=\textwidth, height=6cm]
\addplot[red, no markers] table [skip first n=1, y=r1, x=t]{#1.txt};
\addplot[blue, no markers] table [skip first n=1, y=r2, x=t]{#1.txt};
\addplot[black, no markers] table [skip first n=1, y=ru, x=t]{#1.txt};
\legend{$m_{1, t}$,$m_{2, t}$,$x$}
\end{semilogyaxis}
\end{tikzpicture}

\noindent\begin{tikzpicture}
\begin{semilogyaxis}[xlabel=t,ylabel=Точность решения,width=\textwidth, height=6cm]
\addplot[green, no markers] table [skip first n=1, y=r3, x=t]{#1.txt};
\addplot[orange, no markers] table [skip first n=1, y=r4, x=t]{#1.txt};
\addplot[black, no markers] table [skip first n=1, y=ru, x=t]{#1.txt};
\legend{$m_{3, t}$,$m_{4, t}$,$x$}
\end{semilogyaxis}
\end{tikzpicture}

\noindent\begin{tikzpicture}
\begin{semilogyaxis}[xlabel=t,ylabel=Число итераций,width=\textwidth, height=6cm]
\addplot[red, no markers] table [skip first n=1, y=i1, x=t]{#1.txt};
\addplot[blue, no markers] table [skip first n=1, y=i2, x=t]{#1.txt};
\addplot[black, no markers] table [skip first n=1, y=iu, x=t]{#1.txt};
\legend{$m_{1, t}$,$m_{2, t}$,$x$}
\end{semilogyaxis}
\end{tikzpicture}

\noindent\begin{tikzpicture}
\begin{semilogyaxis}[xlabel=t,ylabel=Число итераций,width=\textwidth, height=6cm]
\addplot[green, no markers] table [skip first n=1, y=i3, x=t]{#1.txt};
\addplot[orange, no markers] table [skip first n=1, y=i4, x=t]{#1.txt};
\addplot[black, no markers] table [skip first n=1, y=iu, x=t]{#1.txt};
\legend{$m_{3, t}$,$m_{4, t}$,$x$}
\end{semilogyaxis}
\end{tikzpicture}
}

\newcommand{\graphgridtime}[1]{
\noindent\begin{tikzpicture}
\begin{semilogyaxis}[xlabel=t,ylabel=Точность решения,width=\textwidth, height=6cm]
\addplot[red, no markers] table [skip first n=1, y=r1, x=t]{#1.txt};
\addplot[blue, no markers] table [skip first n=1, y=r2, x=t]{#1.txt};
\addplot[green, no markers] table [skip first n=1, y=r3, x=t]{#1.txt};
\addplot[orange, no markers] table [skip first n=1, y=r4, x=t]{#1.txt};
\addplot[black, no markers] table [skip first n=1, y=ru, x=t]{#1.txt};
\legend{$m_{1, t}$,$m_{2, t}$,$m_{3, t}$,$m_{4, t}$,$x$}
\end{semilogyaxis}
\end{tikzpicture}

\noindent\begin{tikzpicture}
\begin{semilogyaxis}[xlabel=t,ylabel=Число итераций,width=\textwidth, height=6cm]
\addplot[red, no markers] table [skip first n=1, y=i1, x=t]{#1.txt};
\addplot[blue, no markers] table [skip first n=1, y=i2, x=t]{#1.txt};
\addplot[green, no markers] table [skip first n=1, y=i3, x=t]{#1.txt};
\addplot[orange, no markers] table [skip first n=1, y=i4, x=t]{#1.txt};
\addplot[black, no markers] table [skip first n=1, y=iu, x=t]{#1.txt};
\legend{$m_{1, t}$,$m_{2, t}$,$m_{3, t}$,$m_{4, t}$,$x$}
\end{semilogyaxis}
\end{tikzpicture}
}

\subsubsection{Сетка по пространству}

В данных исследованиях неравномерность применяется к сетке по пространству.

\myparagraph{u = x4 + t}

Исследуется функция $u(x, t) = x^4 + t$, при $\lambda(u) = u*u$.

\graphgrid{x4_space}

\myparagraph{u = exp(x) + t}

Исследуется функция $u(x, t) = e^x + t$, при $\lambda(u) = u*u$.

\graphgrid{expx_space}

\subsubsection{Сетка по времени}

В данных исследованиях неравномерность применяется к сетке по времени.

\myparagraph{u = exp(x) + t3}

Исследуется функция $u(x, t) = e^x + t^3$, при $\lambda(u) = u$.

\graphgridtime{t3_time}

\myparagraph{u = exp(x) + exp(t)}

Исследуется функция $u(x, t) = e^x + e^t$, при $\lambda(u) = u$.

\graphgridtime{expt_time}

\subsection{Точность в зависимости от размера сетки}

В данном пункте определяется \textit{порядок сходимости}. Он равен тому числу, которое стоит в степени функции $x$, которая хорошо аппроксимирует данную зависимость.

\subsubsection{Сетка по пространству}

Исследуется на функции $u(x, t) = e^x+e^t$, при $\lambda(u) = u$.

\noindent\begin{tikzpicture}
\begin{semilogyaxis}[xlabel=Количество элементов сетки,ylabel=Точность решения,width=\textwidth, height=6cm]
\addplot[black, no markers, line width=1pt] table [skip first n=1, y=residual, x=size]{expx_expt_size_space.txt};
\addplot[orange, dashed, line width=1.5pt, smooth, domain=3:202] {0.0255*x^(-0.5)};
\addplot[red, smooth, domain=3:202] {0.0255*5^(0.5)*x^(-1)};
\legend{Точность решения,$0.0255\cdot x^{-0.5}$,$0.0255\cdot \sqrt{5}\cdot x^{-1}$}
\end{semilogyaxis}
\end{tikzpicture}

\textbf{Вывод:} порядок сходимости по пространственной сетке равен $0.5$.

\subsubsection{Сетка по времени}

Исследуется на функции $u(x, t) = e^x+e^t$, при $\lambda(u) = u$.

\noindent\begin{tikzpicture}
\begin{semilogyaxis}[xlabel=Количество элементов сетки,ylabel=Точность решения,width=\textwidth, height=6cm]
\addplot[black, no markers, line width=1pt] table [skip first n=1, y=residual, x=size]{expx_expt_size_time.txt};
\addplot[red, dashed, line width=1.5pt, smooth, domain=3:202] {0.08*x^(-1)};
\addplot[blue, smooth, domain=3:202] {0.08*5*x^(-2)};
\legend{Точность решения,$0.08\cdot x^{-1}$,$0.08\cdot 5\cdot x^{-2}$}
\end{semilogyaxis}
\end{tikzpicture}

\textbf{Вывод:} порядок сходимости по временной сетке равен $1$.

\section{Выводы}

\noindent\begin{easylist}
\ListProperties(Hang=true, Margin2=12pt, Style1**=$\bullet$ , Hide2=1, Hide1=1)
& Порядок аппроксимации метода конечных элементов с линейными элементами с первыми краевыми условиями равен ? при нелинейности $\lambda = 1$, и ? при нелинейности $\lambda = u$.
& TODO...
& TODO...
& TODO...
& TODO...
\end{easylist}

\section{Код программы}

\mycodeinput{c++}{../main.cpp}{main.cpp}